rule Exploit_MacOS_Vortex_B_2147816729_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.B!MTB"
        threat_id = "2147816729"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "5"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "/Users/coolstar/Developer/Odyssey14/Taurine/exploit" ascii //weight: 1
        $x_1_2 = "/taurine/amfidebilitate.plist" ascii //weight: 1
        $x_1_3 = "/taurine/launchjailbreak" ascii //weight: 1
        $x_1_4 = "/.disable_tweakinject" ascii //weight: 1
        $x_1_5 = "/var/MobileSoftwareUpdate/rootfsmnt" ascii //weight: 1
        $x_1_6 = "/taurine/pspawn_payload.dylib" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (5 of ($x*))
}

rule Exploit_MacOS_Vortex_D_2147903260_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.D!MTB"
        threat_id = "2147903260"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "checkra1n" ascii //weight: 1
        $x_1_2 = "jailbreak-capability" ascii //weight: 1
        $x_1_3 = "usr/libexec/cydia/cydo" ascii //weight: 1
        $x_1_4 = "webra1n" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_MacOS_Vortex_F_2147906204_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.F!MTB"
        threat_id = "2147906204"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "4"
        strings_accuracy = "High"
    strings:
        $x_2_1 = "Fugu15KernelExploit" ascii //weight: 2
        $x_1_2 = "runningUnderPiranha" ascii //weight: 1
        $x_1_3 = "JailbreakViewV4body" ascii //weight: 1
        $x_1_4 = "codelessKext.swift" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((1 of ($x_2_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

rule Exploit_MacOS_Vortex_G_2147910255_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.G!MTB"
        threat_id = "2147910255"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "3"
        strings_accuracy = "High"
    strings:
        $x_1_1 = "openpwnage" ascii //weight: 1
        $x_1_2 = "spray_ports" ascii //weight: 1
        $x_1_3 = "unsandboxing" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (all of ($x*))
}

rule Exploit_MacOS_Vortex_H_2147913927_0
{
    meta:
        author = "defender2yara"
        detection_name = "Exploit:MacOS/Vortex.H!MTB"
        threat_id = "2147913927"
        type = "Exploit"
        platform = "MacOS: "
        family = "Vortex"
        severity = "Critical"
        info = "MTB: Microsoft Threat Behavior"
        signature_type = "SIGNATURE_TYPE_MACHOHSTR_EXT"
        threshold = "12"
        strings_accuracy = "High"
    strings:
        $x_5_1 = "checkra1n_flags" ascii //weight: 5
        $x_5_2 = "palera1n_flags" ascii //weight: 5
        $x_1_3 = "status_exploit_code_exec" ascii //weight: 1
        $x_1_4 = "cores/create_fakefs.sh" ascii //weight: 1
        $x_1_5 = "setup-fakefs" ascii //weight: 1
        $x_1_6 = "checkra1n-kpf-ploosh" ascii //weight: 1
    condition:
        (filesize < 20MB) and
        (
            ((2 of ($x_5_*) and 2 of ($x_1_*))) or
            (all of ($x*))
        )
}

